# Классический Checkout с кнопкой "Менеджер"

Этот плагин теперь поддерживает классический checkout вместо блочного редактора WooCommerce с встроенной кнопкой "Связаться с менеджером".

## Как использовать

### 1. Замена блочного checkout на классический

Вместо использования блочного checkout в редакторе страниц, используйте новый шорткод:

```
[classic_checkout]
```

### 2. Функциональность кнопки "Менеджер"

- **Автоматическое отображение**: Кнопка "Связаться с менеджером" автоматически появляется на всех страницах checkout
- **Модальное окно**: При нажатии открывается удобное модальное окно с контактными данными
- **Множественные способы связи**: Телефон, WhatsApp, Email
- **Адаптивный дизайн**: Корректно отображается на мобильных устройствах

### 3. Настройка контактных данных

Чтобы изменить контактные данные в модальном окне, отредактируйте метод `add_manager_button()` в файле `cdek-delivery-plugin.php`:

```php
// Телефон
<a href="tel:+78001234567">+7 (800) 123-45-67</a>

// WhatsApp
<a href="https://wa.me/78001234567">Написать в WhatsApp</a>

// Email
<a href="mailto:manager@dobriytravnik.ru">manager@dobriytravnik.ru</a>
```

### 4. Замена страницы checkout

#### Способ 1: Через редактор страниц
1. Перейдите в админке WordPress к странице "Оформление заказа" 
2. Замените блочный контент на шорткод `[classic_checkout]`

#### Способ 2: Через файл темы
Если вы хотите полностью заменить стандартную страницу checkout, создайте файл `page-checkout.php` в теме:

```php
<?php
get_header();
?>

<div class="container">
    <div class="checkout-page">
        <?php echo do_shortcode('[classic_checkout]'); ?>
    </div>
</div>

<?php
get_footer();
?>
```

### 5. Стилизация

Все стили включены инлайн для простоты, но вы можете вынести их в отдельный CSS файл:

```css
.manager-contact-section {
    margin-bottom: 30px;
    padding: 20px;
    background: #f8f9fa;
    border: 2px solid #007cba;
    border-radius: 8px;
}

#contact-manager-btn {
    background: #007cba;
    color: white;
    padding: 12px 24px;
    border: none;
    border-radius: 5px;
    font-size: 16px;
    font-weight: bold;
    cursor: pointer;
    transition: background-color 0.3s ease;
}

#contact-manager-btn:hover {
    background: #005a87;
}
```

### 6. Логирование

Все обращения к менеджеру логируются в WordPress error log для отслеживания:

```
Клиент запросил связь с менеджером: phone, данные: {"name":"Иван","phone":"+7123456789"}
```

### 7. Безопасность

- Используется WordPress nonce для защиты AJAX запросов
- Все пользовательские данные санитизируются
- Модальное окно не отправляет данные на сервер без явного согласия

## Преимущества классического checkout

1. **Полная совместимость** с существующими плагинами WooCommerce
2. **Кнопка менеджера** всегда видна и доступна
3. **Быстрая загрузка** без дополнительных блочных скриптов
4. **Простая кастомизация** через хуки WordPress
5. **Мобильная адаптивность** из коробки

## Техническая информация

- **Хук для кнопки**: `woocommerce_checkout_before_customer_details`
- **Шорткод**: `[classic_checkout]`
- **AJAX обработчик**: `ajax_contact_manager`
- **Зависимости**: WooCommerce 8.0+, WordPress 5.0+

## Поддержка

Если у вас возникли вопросы по настройке или использованию, обратитесь к разработчику плагина.